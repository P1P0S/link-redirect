<!DOCTYPE html>
<html lang="en">
  <head>
    <title>All links</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>

    <% for(let i=0; i < links.length; i++){ %>
    <div id="<%= links[i]._id%>">
      <h2><%= links[i].title%></h2>
      <div>
        <%= links[i].description%>
      </div>
      <div>
        <%= links[i].url%>
      </div>
      <button type="button" onclick="deleteLink('<%= links[i]._id %>')">Delete</button>
    </div>
    <% } %>

    <script>
      function deleteLink(id){
        fetch("/" + id, {method: "DELETE"}).then(res => {
          if(res.status == 200) {
            res.text().then(linkId => {
              document.getElementById(id).remove()
              })}else{
                res.json().then(err => {
                  console.log(err.message);
            })
          }
        })
      }
    </script>
  </body>
</html>
